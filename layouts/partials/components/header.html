<header>
  <nav aria-label="Main navigation">
    <ul>
      {{/* 1. Dynamic Menu Loop (from config.yaml) */}}
      {{ range site.Menus.main }}
      {{ $isActive := eq .URL $.RelPermalink }}
      {{/* Robust Active Check: matches /projects/agda to /projects */}}
      {{ if and (not $isActive) (ne .URL "/") (hasPrefix $.RelPermalink .URL) }}
      {{ $isActive = true }}
      {{ end }}

      <li>
        <a href="{{ .URL }}"
           class="nav-link {{ if $isActive }}active{{ end }}"
           data-page="{{ .Identifier | urlize }}">
          {{ .Name }}
        </a>
      </li>
      {{ end }}

      {{/* 2. Theme Toggle (Text-based to match redesign) */}}
      <li class="theme-lock">
        <button class="theme-btn" data-theme-toggle aria-label="Toggle theme" title="Switch Theme">
          LIGHT
        </button>
      </li>
    </ul>
  </nav>
</header>