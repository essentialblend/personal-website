{{/* layouts/partials/sections/projectsSection.html */}}

<section class="notes-list projects-list">
  {{ range .Pages.ByDate.Reverse }}
  <a href="{{ .RelPermalink }}" class="note-row">
    {{ $projectTitle := .Title }}

    <div class="note-main LP_STACK LP_STACK_INTER_SMALL">
      <span class="note-title">{{ .Title }}</span>

      {{ with .Params.description }}
      <span class="note-desc">{{ . }}</span>
      {{ else }}
      {{ with .Summary }} <span class="note-desc">{{ . }}</span> {{ end }}
      {{ end }}

      {{ $stacks := .Params.stacks }}
      {{ $repo := .Params.repo }}
      {{ $hasStacks := gt (len $stacks) 0 }}

      {{ if or $hasStacks $repo }}
      <div class="SF_PROJECT_STACK">
        {{ range $index, $stack := $stacks }}
        {{ if $index }}<span class="tag-sep">&bull;</span>{{ end }}
        {{ $assumedUrl := printf "/%s/%s/" "stacks" (. | urlize) }}
        <span
          class="SF_METADATA_TAG SF_METADATA_TAG--stack"
          role="link"
          tabindex="0"
          onclick="event.preventDefault(); event.stopPropagation(); window.location.href='{{ $assumedUrl | relLangURL }}';"
          onkeydown="if(event.key==='Enter' || event.key===' '){event.preventDefault(); event.stopPropagation(); window.location.href='{{ $assumedUrl | relLangURL }}';}"
        >{{ $stack }}</span>
        {{ end }}

        {{ with $repo }}
        {{ if $hasStacks }}<span class="tag-sep">&bull;</span>{{ end }}
        <span
          class="SF_METADATA_TAG SF_METADATA_TAG--link"
          role="link"
          tabindex="0"
          aria-label="Open repository for {{ $projectTitle }}"
          onclick="event.preventDefault(); event.stopPropagation(); window.open('{{ . }}','_blank','noopener');"
          onkeydown="if(event.key==='Enter' || event.key===' '){event.preventDefault(); event.stopPropagation(); window.open('{{ . }}','_blank','noopener');}"
        >
          Repo
        </span>
        {{ end }}
      </div>
      {{ end }}
    </div>

    <div class="note-meta LP_STACK LP_STACK_INTER_SMALL">
      <span class="note-date">{{ .Date.Format "Jan 2006" }}</span>

      {{ $status := .Params.status | default "ongoing" | lower }}
      <span class="status-tag {{ $status }}">
        {{ if eq $status "complete" }}Completed{{ else if eq $status "archived" }}Archived{{ else }}Ongoing{{ end }}
      </span>
    </div>

  </a>
  {{ else }}
  <p>No projects listed yet.</p>
  {{ end }}
</section>
